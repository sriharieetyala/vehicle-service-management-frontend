<div class="page-container">
    <div class="container">
        <div class="page-header">
            <a routerLink="/admin" class="back-link"><i class="bi bi-arrow-left"></i> Back to Dashboard</a>
            <h1><i class="bi bi-people"></i> Technician Workload</h1>
            <p class="subtitle">Current task assignments by technician</p>
        </div>

        <!-- Stats Row -->
        <div class="stats-row">
            <div class="stat-box">
                <span class="stat-value">{{ totalTechnicians }}</span>
                <span class="stat-label">Active Technicians</span>
            </div>
            <div class="stat-box">
                <span class="stat-value">{{ activeTasks }}</span>
                <span class="stat-label">Total Tasks</span>
            </div>
            <div class="stat-box">
                <span class="stat-value">{{ averageLoad }}</span>
                <span class="stat-label">Avg Tasks/Tech</span>
            </div>
        </div>

        @if (isLoading) {
        <div class="loading">Loading report...</div>
        } @else if (technicians.length === 0) {
        <div class="empty-state">
            <i class="bi bi-people"></i>
            <p>No active technicians</p>
        </div>
        } @else {
        <table class="data-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Specialization</th>
                    <th>Current Tasks</th>
                    <th>Max Capacity</th>
                    <th>Load</th>
                </tr>
            </thead>
            <tbody>
                @for (tech of technicians; track tech.id) {
                <tr>
                    <td><strong>{{ tech.firstName }} {{ tech.lastName }}</strong></td>
                    <td>{{ tech.specialization || 'General' }}</td>
                    <td>{{ tech.currentWorkload || 0 }}</td>
                    <td>{{ tech.maxWorkload || 5 }}</td>
                    <td>
                        <div class="progress-bar">
                            <div class="progress-fill" [class]="getLoadClass(tech)"
                                [style.width.%]="((tech.currentWorkload || 0) / (tech.maxWorkload || 5)) * 100"></div>
                        </div>
                    </td>
                </tr>
                }
            </tbody>
        </table>
        }
    </div>
</div>